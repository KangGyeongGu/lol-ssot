## 0. 이 문서의 목적
- 이 문서는 프론트엔드 구현을 위한 사용자 흐름 정의서다.
- 페이지 단위 이동과 페이지 내부 상태 전환을 구분한다.
- 정책을 새로 정의하지 않으며, 흐름에 필요한 분기 결과만 기술한다.
  - 정책/권한/검증의 기준은 REQUIREMENTS / GAME_RULES / API 문서를 따른다.
- Antigravity가 이 문서를 기반으로 페이지 구성과 라우팅 흐름을 구현할 수 있어야 한다.

## 관련 문서
- [[01_PRODUCT/REQUIREMENTS.md]]
- [[01_PRODUCT/GAME_RULES.md]]
- [[01_PRODUCT/COPY_TEXT.md]]

---
## 1. 전체 페이지 구성
### 1.1 게임 관련 페이지
게임과 직접적으로 연관된 페이지는 아래 4개로 고정된다.
1. WAITING_ROOM
2. BAN_PICK_SHOP (RANKED 전용)
3. IN_GAME
4. RESULT

### 1.2 서비스 페이지/상태
- WELCOME (로그인)
- MAIN
- MY_PAGE
- SIGNUP 오버레이 (WELCOME 위 상태)
- ROOM_LIST 패널 상태 (MAIN 헤더 하단 교체 상태)

---
## 2. 전역 사용자 진입 흐름
### 2.1 최초 진입
1. 사용자가 웹사이트에 접근한다.
2. 로그인 여부를 확인한다.
   - 미로그인 상태: WELCOME으로 이동한다.
   - 로그인 상태: 서버에 active game 존재 여부를 조회한다.
3. active game 조회 결과에 따라 이동한다.
   - active game 없음: MAIN으로 이동한다.
   - active game 있음: 해당 게임의 현재 stage에 맞는 게임 페이지로 이동한다.
     - LOBBY -> WAITING_ROOM
     - BAN/PICK/SHOP -> BAN_PICK_SHOP
     - PLAY -> IN_GAME
4. FINISHED는 active game 복귀 대상이 아니며, RESULT는 연결 중 GAME_FINISHED 이벤트로만 표시된다.

### 2.2 active game 제약
- active game이 존재하는 동안 사용자의 다른 게임 진입 액션(새 방 생성/다른 방 참가)은 차단된다.

---
## 3. 로그인/회원가입 흐름
### 3.1 WELCOME 흐름
1. 사용자는 WELCOME에서 카카오 로그인을 시도한다.
2. 로그인 결과에 따라 분기한다.
   - 기존 회원:
     - 로그인 상태로 전환한다.
     - active game 조회 후 MAIN 또는 게임 복귀 페이지로 이동한다.
   - 미회원:
     - 서버가 SIGNUP_REQUIRED를 반환한다.
     - WELCOME 위에 SIGNUP 오버레이를 표시한다.

### 3.2 SIGNUP 오버레이 흐름
1. 사용자는 닉네임과 주 사용 프로그래밍 언어를 입력한다.
2. 회원가입 요청을 제출한다.
3. 가입 완료 시 로그인 상태로 전환한다.
4. active game 조회 결과에 따라 MAIN 또는 게임 복귀 페이지로 이동한다.

---
## 4. MAIN 흐름
### 4.1 목적
- 서비스 현재 상태를 요약 제공하고 게임 진입 시작점 역할을 한다.

### 4.2 기본 상태 구성
- 실시간 알고리즘 밴률/픽률 리스트
- 실시간 플레이어 점수 랭킹 대시보드
- 전역 채팅 영역
- 방 생성 버튼
- ROOM_LIST 패널 전환 버튼
- MY_PAGE 이동 버튼

### 4.3 기본 상태 사용자 액션
- ROOM_LIST 패널 열기/닫기
- 방 생성
- MY_PAGE 이동
- 전역 채팅 송신

### 4.4 ROOM_LIST 패널 상태
- MAIN 헤더 하단 영역만 ROOM_LIST 패널로 교체된다.
- 주요 구성:
  - 방 리스트
  - 검색/필터 (방 이름, 프로그래밍 언어, 게임 유형)
  - 업데이트 인디케이터(새 방/삭제/순서 변경 누적)
- 동기화 규칙:
  - 현재 화면에 보이는 방 카드 상태값은 실시간 자동 갱신
  - 현재 범위 밖 변화는 배지/하이라이트로만 알림
  - 업데이트 적용 버튼으로 최신 목록 반영
- 사용자 액션:
  - 검색/필터 적용
  - 방 참가 요청
    - 강퇴된 사용자 재입장 요청은 실패 분기로 처리한다.
  - 패널 닫기(기본 MAIN 상태 복귀)

---
## 5. WAITING_ROOM 흐름
### 5.1 목적
- 게임 시작 전 플레이어 준비 상태를 관리한다.

### 5.2 주요 구성
- 플레이어 슬롯 목록 (READY/UNREADY/DISCONNECTED)
- 룸 채팅 영역
- 방 설정 요약 영역
- 방장 전용 컨트롤 영역

### 5.3 사용자 액션
- READY/UNREADY 전환 (방장 제외)
- 룸 채팅
- 방장인 경우:
  - 게임 시작
  - 플레이어 강퇴

### 5.4 페이지 전환 조건
- 게임 시작 요청은 "모든 플레이어 READY + 방장 실행" 조건 충족 시에만 성공한다.
- NORMAL: 시작 성공 시 IN_GAME으로 이동
- RANKED: 시작 성공 시 BAN_PICK_SHOP으로 이동

### 5.5 상태 변경
- 방장 이탈 시 서버가 신규 방장을 위임하며, WAITING_ROOM은 방장 표시 상태를 갱신한다.

---
## 6. BAN_PICK_SHOP 흐름 (RANKED 전용)
### 6.1 목적
- 게임 시작 전 전략 선택을 수행한다.

### 6.2 페이지 특성
- 단일 페이지 내부에서 stage(BAN -> PICK -> SHOP)만 전환된다.
- WAITING_ROOM에서 사용하던 룸 채팅 스코프를 그대로 유지한다.

### 6.3 내부 단계 사용자 액션
1. BAN: 알고리즘 밴 제출
2. PICK: 알고리즘 픽 제출
3. SHOP: 아이템/스펠 구매
4. 룸 채팅 송신

### 6.4 페이지 전환 조건
- SHOP 종료 시 IN_GAME으로 이동한다.

---
## 7. IN_GAME 흐름
### 7.1 목적
- 알고리즘 코드 배틀을 수행한다.

### 7.2 주요 구성
- 코드 에디터 영역
- 문제 설명 영역
- 상단 플레이어 실시간 화면 영역
- 플레이어 타이핑 상태 표시 바
- 아이템/스펠 인벤토리 (RANKED 전용)
- 룸 채팅 영역
- 남은 플레이 시간 표시

### 7.3 사용자 액션
- 코드 작성/제출
- 아이템 사용 (RANKED, 상대 대상)
- 스펠 사용 (RANKED, 자기 대상)
- 룸 채팅

### 7.4 종료 흐름
- 게임 종료 시 RESULT를 표시한다.

---
## 8. RESULT 흐름
### 8.1 목적
- 게임 결과와 보상을 확인한다.

### 8.2 주요 구성
- 결과 상태 (WIN/LOSE/DRAW)
- 점수/코인/경험치 변화량 (RANKED만 노출, NORMAL은 0 또는 미표시)
- MAIN 이동 버튼
- MY_PAGE 이동 버튼

### 8.3 사용자 액션
- MAIN 이동
- MY_PAGE 이동

---
## 9. MY_PAGE 흐름
### 9.1 목적
- 개인 기록과 성과를 확인한다.

### 9.2 주요 구성
- 프로필 정보
- 티어 정보
- 통계
- 전적 목록

---
## 10. USER_FLOWS 문서 사용 규칙
- 이 문서는 UI/UX 흐름을 정의한다.
- 정책/검증 기준은 REQUIREMENTS / GAME_RULES / API 문서를 따른다.
- 이 문서에 명시되지 않은 페이지/상태/이동 흐름은 구현하지 않는다.
