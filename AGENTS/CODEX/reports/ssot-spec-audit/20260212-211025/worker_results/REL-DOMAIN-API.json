{
  "run_id": "20260212-211025",
  "agent_id": "relation-auditor",
  "task_id": "REL-DOMAIN-API",
  "target": {
    "kind": "relation",
    "id": "DOMAIN_API"
  },
  "status": "warn",
  "summary": "Found 2 medium DOMAIN_API consistency issues: one-way cross-area references (DOMAIN->API only) and a stage mapping drift in ROOM_GAME_STARTED.",
  "findings": [
    {
      "severity": "medium",
      "code": "REL_REQUIRED_LINK_PRESENCE_GAP",
      "message": "DOMAIN documents reference API contracts, but API contract docs do not reference DOMAIN SSOT docs, leaving DOMAIN_API traceability one-directional.",
      "dedupe_key": "domain_api_link_directionality",
      "evidence": [
        {
          "path": "04_DOMAIN/DATA_MODEL.md",
          "line": 12,
          "snippet": "- 03_API/CONTRACT/REST/OPENAPI.yaml.md"
        },
        {
          "path": "04_DOMAIN/REDIS_DB_TIMING.md",
          "line": 8,
          "snippet": "- [[03_API/LIFECYCLE.md]]"
        },
        {
          "path": "03_API/CONTRACT/REST/OPENAPI.yaml.md",
          "line": 30,
          "snippet": "- [[03_API/CONTRACT/REST/API_SUMMARY.md]]"
        },
        {
          "path": "03_API/CONTRACT/REALTIME/CONVENTIONS.md",
          "line": 7,
          "snippet": "- [[03_API/CONTRACT/REALTIME/TOPICS.md]]"
        }
      ],
      "proposed_fix": "Add explicit related-doc links from core API contract docs (e.g., `03_API/README.md`, `03_API/CONTRACT/REST/OPENAPI.yaml.md`, `03_API/CONTRACT/REALTIME/CONVENTIONS.md`) to `04_DOMAIN/DATA_MODEL.md` and, where relevant, `04_DOMAIN/REDIS_DB_TIMING.md`."
    },
    {
      "severity": "medium",
      "code": "ENTITY_CONTRACT_STAGE_MAPPING_DRIFT",
      "message": "`ROOM_GAME_STARTED` event allows `PICK`/`SHOP` stages, but the domain transition model defines game start as `BAN` (RANKED) or `PLAY` (NORMAL), creating ambiguous Domain<->API stage semantics.",
      "dedupe_key": "domain_api_room_game_started_stage",
      "evidence": [
        {
          "path": "04_DOMAIN/DATA_MODEL.md",
          "line": 674,
          "snippet": "- NORMAL: LOBBY → PLAY → FINISHED"
        },
        {
          "path": "04_DOMAIN/DATA_MODEL.md",
          "line": 675,
          "snippet": "- RANKED: LOBBY → BAN → PICK → SHOP → PLAY → FINISHED"
        },
        {
          "path": "03_API/CONTRACT/REALTIME/EVENTS.md",
          "line": 187,
          "snippet": "- stage: GameStage (BAN | PICK | SHOP | PLAY)"
        }
      ],
      "proposed_fix": "Constrain `ROOM_GAME_STARTED.data.stage` to `BAN | PLAY`, or clarify in the event spec that this event may represent post-start re-entry snapshots (and align domain text accordingly)."
    }
  ],
  "metrics": {
    "files_scanned": 24,
    "links_checked": 7,
    "relations_checked": 3
  },
  "started_at": "2026-02-12T12:10:25Z",
  "finished_at": "2026-02-12T12:20:31Z"
}
